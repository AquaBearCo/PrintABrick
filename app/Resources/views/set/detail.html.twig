{% extends 'base.html.twig' %}

{% block title %}{{ set ? set.number }}  {{ set ? set.name }}{% endblock %}

{% block header %}{{ set ? set.number }}  {{ set ? set.name | escape('html') }}{% endblock %}

{% block content %}

    <div class="ui stackable grid">
        <div class="column nine wide">
            <div class="image bordered ui big">
                {% if brset %}
                    <img class="big" src="{{ ('/sets/images/'~brset.legoSetID~'.jpg')|imagine_filter('brickset_large') }}">
                {% else %}
                    <img class="big" src="{{ set.number|setImage|imagine_filter('rebrickable_large') }}">
                {% endif %}
            </div>
        </div>
        <div class="column seven wide">
            <div class="item-info ui">
                <table class="ui very basic table">
                    <tr>
                        <td>{{ 'set.number' | trans }}</td><td>{{ brset ? brset.legoSetID :  set ? set.number : null}}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.name' | trans }}</td><td>{{ brset ? brset.name :  set ? set.name : null}}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.year' | trans }}</td><td>{{ brset ? brset.year :  set ? set.year : null}}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.theme' | trans }}</td>
                        {% if set %}
                            <td><a href="#">{{ set.theme.parent ? set.theme.parent.name }}</a>  <a href="#">{{ set.theme.name }}</a> </td>
                        {% elseif brset %}
                            <td>{{ brset.theme }}</td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td>{{ 'set.parts' | trans }}</td><td>
                            {{  set ? set.partCount }} {{ brset ? '('~brset.pieces~')' }}
                        </td>
                    </tr>
                    {% if brset %}
                        <tr>
                            <td>{{ 'set.minifigs' | trans }}</td>
                            <td>{{ brset.minifigs }}</td>
                        </tr>
                        <tr>
                            <td>{{ 'set.rating' | trans }}</td>
                            <td>
                                {{ brset.rating }}/5
                            </td>
                        </tr>
                    {% endif %}
                        <tr>
                            <td></td>
                            <td>
                                <a class="rebrickable link" href="http://rebrickable.com/sets/{{ set ? set.number }}">Rebrickable</a>
                                {% if brset %}
                                <a class="brickset link" href="{{ brset.bricksetURL }}">Brickset</a>
                                {% endif %}
                            </td>
                        </tr>
                </table>

                <a class="ui download primary button">{{ 'set.download'|trans }}</a>
                <div class="ui download flowing popup bottom center transition hidden">
                    <div class="ui two column divided center aligned grid">
                        <div class="column">
                            <h4 class="ui header">{{ 'set.download.sorted' }}</h4>
                            <p>{{ 'set.download.sorted.text' | trans }}</p>
                            <a class="ui button" href="{{ path('set_zip', {number: set.number, sorted: true }) }}" download>Download ZIP</a>
                        </div>
                        <div class="column">
                            <h4 class="ui header">{{ 'set.download.unsorted' }}</h4>
                            <p>{{ 'set.download.unsorted.text' | trans }}</p>
                            <a class="ui button" href="{{ path('set_zip', {number: set.number, sorted: false }) }}" download>Download ZIP</a>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>

    <div class="ui segment vertical item-info">
        <div class="ui tabular pointing secondary menu">
            <a class="item active" data-tab="parts"><i class="cubes icon"></i> Inventory ({{ set ? set.partCount : 0}})</a>
            {% if brset %}
                <a class="item" data-tab="description"><i class="info icon"></i> Description</a>
                <a class="item" data-tab="images"> <i class="image icon"></i> Images ({{ brset.additionalImageCount }})</a>
                <a class="item" data-tab="instructions"> <i class="file pdf outline icon"></i> Instructions ({{ brset.instructionsCount }})</a>
                <a class="item" data-tab="reviews"><i class="write icon"></i> Reviews ({{ brset.reviewCount }})</a>
            {% endif %}
        </div>
        <div class="ui vertical segment">
            <div class="ui tab active" data-tab="parts">
                <div class="ajax-load" data-src="{{ path('set_models', { 'number': set.number }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>

                {#{{ render(path('set_colors', {number: set.number})) }}#}
            </div>
            {% if brset %}
                <div class="ui tab ajax-load" data-tab="description" data-src="{{ path('brickset_description', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="images" data-src="{{ path('brickset_images', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="instructions" data-src="{{ path('brickset_instructions', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="reviews" data-src="{{ path('brickset_reviews', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}