{% extends 'base.html.twig' %}

{% import 'macros/blocks.html.twig' as blocks %}

{% block title %}{{ set.number }} {{ set.name }}{% endblock %}

{% block header %}{{ set.number }}  {{ set.name | escape('html') }}{% endblock %}

{% block content %}

    <div class="ui stackable grid">
        <div class="column nine wide">
            <div class="ui bordered fluid image">
                {{ blocks.setImage(set.number,'set_large') }}
            </div>
        </div>
        <div class="column seven wide">
            <div class="item-info ui">
                <table class="ui very basic table">
                    <tr>
                        <td>{{ 'set.number' | trans }}</td><td>{{ set.number }}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.name' | trans }}</td><td>{{ set.name }}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.year' | trans }}</td><td>{{ set.year }}</td>
                    </tr>
                    <tr>
                        <td>{{ 'set.theme' | trans }}</td>
                        <td><a href="#">{{ set.theme.parent ? set.theme.parent.name }}</a> &gt; <a href="#">{{ set.theme ? set.theme.name }}</a> </td>
                    </tr>
                    <tr>
                        <td>{{ 'set.parts' | trans }}</td><td>
                            {{ set.partCount }} {{ brset ? '('~brset.pieces~')' }}
                        </td>
                    </tr>
                    {% if brset %}
                        <tr>
                            <td>{{ 'set.minifigs' | trans }}</td>
                            <td>{{ brset.minifigs }}</td>
                        </tr>
                        <tr>
                            <td>{{ 'set.rating' | trans }}</td>
                            <td>
                                {{ brset.rating }}/5
                            </td>
                        </tr>
                    {% endif %}
                    <tr>
                        <td></td>
                        <td>
                            <a class="rebrickable link" href="http://rebrickable.com/sets/{{ set ? set.number }}">Rebrickable</a>
                            {% if brset %}
                                <a class="brickset link" href="{{ brset.bricksetURL }}">Brickset</a>
                            {% endif %}
                        </td>
                    </tr>
                </table>


                <div class="ui primary open-modal button">{{ 'set.download' | trans }}</div>

                {% embed 'embeds/modal.html.twig' %}
                    {% block title %}
                        {{ 'set.download.title' | trans({'%set%': set.number~' '~set.name}) }}
                    {% endblock %}
                    {% block content %}
                        {#<div class="ui icon message">#}
                            {#<i class="warning icon"></i>#}
                            {#<div class="content">#}
                                {#<div class="header">#}
                                    {#{{ 'set.download.warning.title' | trans }}#}
                                {#</div>#}
                                {#<p> {{ 'set.download.warning.text' | trans }}</p>#}
                            {#</div>#}
                        {#</div>#}
                    {% endblock %}
                    {% block actions %}
                        <div class="ui two column divided center aligned grid">
                            <div class="column">
                                <h4 class="ui header">{{ 'set.download.sorted.title' | trans }}</h4>
                                <p>{{ 'set.download.sorted.text' | trans }}</p>
                                <a class="ui download button" href="{{ path('set_zip', {number: set.number, sorted: true }) }}" download>Download ZIP</a>
                            </div>
                            <div class="column">
                                <h4 class="ui header">{{ 'set.download.unsorted.title' | trans }}</h4>
                                <p>{{ 'set.download.unsorted.text' | trans }}</p>
                                <a class="ui download button" href="{{ path('set_zip', {number: set.number, sorted: false }) }}" download>Download ZIP</a>
                            </div>
                        </div>
                    {% endblock %}
                {% endembed %}

            </div>
        </div>
    </div>

    <div class="ui segment vertical item-info">
        <div class="ui tabular pointing secondary menu">
            <a class="item active" data-tab="parts"><i class="cubes icon"></i> Inventory ({{ set ? set.partCount : 0}})</a>
            {% if brset %}
                <a class="item" data-tab="description"><i class="info icon"></i> Description</a>
                <a class="item" data-tab="images"> <i class="image icon"></i> Images ({{ brset.additionalImageCount }})</a>
                <a class="item" data-tab="instructions"> <i class="file pdf outline icon"></i> Instructions ({{ brset.instructionsCount }})</a>
                <a class="item" data-tab="reviews"><i class="write icon"></i> Reviews ({{ brset.reviewCount }})</a>
            {% endif %}
        </div>
        <div class="ui vertical segment">
            <div class="ui tab active" data-tab="parts">
                {#<div class="ui icon buttons right floated">#}
                    {#<button class="ui button"><i class="grid layout icon"></i></button>#}
                    {#<button class="ui button"><i class="list layout icon"></i></button>#}
                {#</div>#}

                <p>{{ 'set.models.text' | trans({'%rebrickable%' : partCount, '%brickset%' : brset ?     brset.pieces }) | nl2br }}</p>

                <div class="ajax-load" data-src="{{ path('set_models', { 'number': set.number }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>

                {#{{ render(path('set_models', {number: set.number})) }}#}
                {{ render(path('set_sets', {number: set.number})) }}
            </div>
            {% if brset %}
                <div class="ui tab ajax-load" data-tab="description" data-src="{{ path('brickset_description', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="images" data-src="{{ path('brickset_images', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="instructions" data-src="{{ path('brickset_instructions', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
                <div class="ui tab ajax-load" data-tab="reviews" data-src="{{ path('brickset_reviews', { 'id': brset.setID }) }}">
                    <div class="ui active centered inline loader"></div>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}